{% extends "lfs_lab_cert_tracker/base.html" %}
{% load custom_tags %}

{% block top_menu_nav %}
	{% include "lfs_lab_cert_tracker/subpages/top_menu.html" %}
{% endblock %}

{% include 'app/subpages/_return_message.html' with data=messages %}

{% block content %}

{% include 'key_request/left_side_menu.html' %}

<section class="main-content">
	<h3 class="title">All Requests</h3>

	<table class="table table-bordered table-hover table-striped">
	  <thead>
	    <tr>
	      <th>ID</th>
	      <th>CWL</th>
	      <th>Full Name</th>
	      <th>Form <br /> Details</th>
	      <th>Status <br /> History</th>
	      <th>Submitted At</th>
	      <th>Actions</th>
	    </tr>
	  </thead>
	  <tbody>
	    {% for form in forms %}
	      <tr>
	        <td>{{ form.id }}</td>
	        <td>
	          <a href="{% url 'app:user_details' user_id=user.id %}?next={{ request.get_full_path }}">{{ form.user.username }}</a>
	        </td>
	        <td>{{ form.user.get_full_name }}</td>
	        <td>
						{% include 'key_request/subpages/modal_request_form_details.html' with id=forloop.counter form=form is_admin='True' %}
	        </td>
	        <td>
						{% if form.requestformstatus_set.all|length > 0 %}
							{% include 'key_request/subpages/modal_status_history.html' with id=forloop.counter data=form.requestformstatus_set.all %}
						{% endif %}
	        </td>
	        <td>
						{% include 'key_request/subpages/date_and_time.html' with data=form.submitted_at %}
	        </td>
	        <td>
	          <a class="d-block" href="{% url 'key_request:view_form_details' form_id=form.id %}">Details</a>
	        </td>
	      </tr>
	    {% endfor %}
	  </tbody>
	</table>
</section>

{% endblock %}
