{% extends "lfs_lab_cert_tracker/base.html" %}

{% block top_menu_nav %}
	{% include "lfs_lab_cert_tracker/subpages/top_menu.html" %}
	{% include 'app/subpages/_return_message.html' with data=messages %}
{% endblock %}

{% block content %}

{% include 'key_request/left_side_menu.html' %}

<section class="main-content">
	<h3 class="title">
		All {{ model }}s
		<small class="text-secondary">(Total: {{ total_items }})</small>
	</h3>

	<div class="row">
	  <div class="col-md-4">
	    <form method="post">
	      {% csrf_token %}

	      {% for field in form.visible_fields %}
					<div class="field-wrapper">
	          <label for="{{ field.id_for_label }}">
	            {{ field.label }}
	            {% include 'lfs_lab_cert_tracker/icons/asterisk.html' %}
	          </label>
	          {% if field.help_text %}
	            <div class="help">{{ field.help_text|safe }}</div>
	          {% endif %}
	        	{{ field }}
					</div>
	      {% endfor %}
	      <input class="btn btn-primary mt-2" type="submit" value="Create" />
	    </form>
	  </div>
	  <div class="col-md-8">
	    <table
	      class="table table-bordered table-striped table-responsive-md"
	      data-toggle="table"
	      data-classes=""
	      data-pagination="true"
	      data-search="true"
	      data-page-size="10"
	      data-page-list="[10, 20, 30, 50, 100, all]"
	    >
	      <thead>
	        <tr>
	          {% for header in headers %}
	            <th>{{ header }}</th>
	          {% endfor %}
	        </tr>
	      </thead>
	      <tbody>
	        {% for item in items %}
	          <tr>
	            <td>{{ item.id }}</td>
	            <td>{{ item.name }}</td>
							{% if model == 'Building' %}
								<td>{{ item.code }}</td>
							{% endif %}
	            <td>{{ item.created_on }}</td>
	            <td>{{ item.updated_on }}</td>
	            <td>
	              <div class="btn-toolbar">
	                <button class="btn btn-sm fs-8 btn-warning mr-2" type="button" data-toggle="modal" data-target="#settings-model-edit-modal-{{ item.id }}">Edit</button>
	                <div class="modal fade" id="settings-model-edit-modal-{{ item.id }}" tabindex="-1" role="dialog" aria-labelledby="settings-model-edit-modal-label-{{ item.id }}" aria-hidden="true">
	                  <div class="modal-dialog" role="document">
	                    <div class="modal-content">
	                      <div class="modal-header">
	                        <h5 class="modal-title" id="settings-model-edit-modal-label-{{ item.id }}">Edit {{ model }}</h5>
	                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                      </div>
	                      <div class="modal-body">

	                        <div class="modal-item text-left">
	                          <form action="{% url 'key_request:edit_setting' model=raw_model %}" method="post">
	                            {% csrf_token %}

	                            <div class="field-wrapper mt-0">
	                              <label for="id_name_{{ item.id }}" class="form-label">
	                                Name:
	                                {% include 'lfs_lab_cert_tracker/icons/asterisk.html' %}
	                              </label>
	                              <div class="help">Maximum characters: 100</div>
	                              <input id="id_name_{{ item.id }}" class="form-control" type="text" name="name" maxlength="100" value="{{ item.name }}" required />
	                            </div>

															{% if model == 'Building' %}
																<div class="field-wrapper">
		                              <label for="id_code_{{ item.id }}">
		                                Code:
		                                {% include 'lfs_lab_cert_tracker/icons/asterisk.html' %}
		                              </label>
		                              <div class="help">It must be unique. Maximum characters: 20</div>
		                              <input id="id_code_{{ item.id }}" class="form-control" type="text" name="code" maxlength="20" value="{{ item.code }}" required />
		                            </div>
															{% endif %}

	                            <input type="hidden" name="item" value="{{ item.id }}" />
	                            <input class="btn btn-warning mt-2" type="submit" value="Update" />
	                          </form>
	                        </div>

	                      </div>
	                    </div>
	                  </div>
	                </div>

	                <button class="btn btn-sm fs-8 btn-danger" type="button" data-toggle="modal" data-target="#settings-model-delete-modal-{{ item.id }}">Delete</button>
	                <div class="modal fade" id="settings-model-delete-modal-{{ item.id }}" tabindex="-1" role="dialog" aria-labelledby="settings-model-delete-modal-label-{{ item.id }}" aria-hidden="true">
	                  <div class="modal-dialog" role="document">
	                    <div class="modal-content">
	                      <div class="modal-header">
	                        <h5 class="modal-title text-info" id="settings-model-delete-modal-label-{{ item.id }}">Delete {{ model }}</h5>
	                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                      </div>
	                      <div class="modal-body text-left">
                          <h5 class="text-danger">Are you sure to delete this data?</h5>

													<div>
														ID: <strong>{{ item.id }}</strong>
													</div>
                          <div>
                            Name: <strong>{{ item.name }}</strong>
                          </div>

													{% if model == 'Building' %}
														<div>
	                            Code: <strong>{{ item.code }}</strong>
	                          </div>
													{% endif %}

                          <ul class="mt-2 mb-4">
                            <li>Created on: {{ item.created_on }}</li>
                            <li>Updated on: {{ item.updated_on }}</li>
                          </ul>

                          <form action="{% url 'key_request:delete_setting' model=raw_model %}" method="post">
                            {% csrf_token %}

                            <input type="hidden" name="item" value="{{ item.id }}" />
                            <input class="btn btn-danger" type="submit" value="Confirm to delete" />
                          </form>
	                      </div>
	                    </div>
	                  </div>
	                </div>

	              </div>
	            </td>
	          </tr>
	        {% endfor %}
	      </tbody>
	    </table>

	  </div>
	</div>
</section>

{% endblock %}
