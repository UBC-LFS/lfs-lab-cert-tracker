{% extends "base.html" %}

{% block content %}

<div class="row">
	<div class="col-md-8">
		<h4>Users in Lab: {{lab.name}}</h4>
		<div class="list-group">
		{% for user_in_lab in users_in_lab %}
			<div class="list-group-item">
				<p class="float-left">
					{{ user_in_lab.cwl}}
				</p>
				<form class="float-right" action='/api/users/{{user_in_lab.id}}/labs/{{lab.id}}/delete' method="post">
					{% csrf_token %}
					<input name="redirect_url" value="/labs/{{lab.id}}" type="hidden"/>
				<input class="btn btn-danger" type="submit" value="DELETE"/>
				</form>
			</div>
		{% endfor %}
		</div>
		<h4>Users Missing Certs</h4>
		<table class="table">
			<thead>
				<tr>
					<th scope="col">CWL</th>
					<th scope="col">Missing</th>
				</tr>
			</thead>
			<tbody>
			{% for user_missing_certs in users_missing_certs %}
				<tr>
					<th>{{ user_missing_certs.0.cwl}}</th>
					<td>
						<ul>
						{% for missing_cert in user_missing_certs.1 %}
						<li>{{ missing_cert.name }}</li>
						{% endfor %}
						</ul>
					</td>
				</tr>
			{% endfor %}
			</tbody>
		</table>
		<h4>Add User to Lab</h4>
		<form action='/api/labs/{{lab.id}}/users/' method="post">
			{% csrf_token %}
			{{ lab_user_form.as_p }}
			<input name="redirect_url" value="/labs/{{lab.id}}" type="hidden"/>
			<input class="btn btn-primary" type="submit" value="ADD"/>
		</form>
		<h4>Add Cert to Lab</h4>
		<form action='/api/labs/{{lab.id}}/certificates/' method="post">
			{% csrf_token %}
			{{ lab_cert_form.as_p }}
			<input name="redirect_url" value="/labs/{{lab.id}}" type="hidden"/>
			<input class="btn btn-primary" type="submit" value="ADD"/>
		</form>
		<h4>Required Certs</h4>
		<div class="list-group">
			{% for required_cert in required_certs %}
			<div class="list-group-item">
				<p class="d-inline float-left">
					{{ required_cert.name }}
				</p>
				<form class="d-inline float-right" action='/api/labs/{{lab.id}}/certificates/{{required_cert.id}}/delete' method="post">
					{% csrf_token %}
					<input name="redirect_url" value="/labs/{{lab.id}}" type="hidden"/>
					<input class="btn btn-danger" type="submit" value="DELETE"/>
				</form>
			</div>
			{% endfor %}
		</div>
	</div>
</div>

{% endblock %}

