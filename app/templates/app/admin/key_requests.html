{% extends "lfs_lab_cert_tracker/base.html" %}

{% block content %}

{% if request.user.is_superuser %}
	{% include 'app/subpages/_admin_menu.html' %}
{% endif %}

{% include 'app/subpages/_return_message.html' with data=messages %}

<h3 class="my-5">
    Key Requests
	<small class="text-secondary">(Total: {{ total_users }})</small>
</h3>

<div class="search-field mb-2">
	<form method="GET">
		<div class="input-field">
			<input class="search-field-text" type="text" name="q" value="{{ request.GET.q }}" placeholder="Search by CWL or Name">
			<button class="btn btn-secondary btn-sm" type="submit">Search</button>
			<a class="btn btn-sm btn-light" href="{% url 'app:key_requests' %}">Clear</a>
		</div>
	</form>
</div>

<table class="table table-bordered table-striped table-hover table-responsive text-center font-size-sm table-vertical-middle">
  <thead>
    <tr>
        <th>ID</th>
        <th>Full Name</th>
        <th>CWL</th>
        <th>UBC Email</th>
        <th>LFS Role</th>
        <th>UBC Affiliation</th>
        <th>Supervisor First Name</th>
        <th>Supervisor Last Name</th>
        <th>Supervisor Email</th>
        <th>After Hours Access</th>
        <th>Building Name</th>
        <th>Room Numbers</th>
        <th>Additional Comments</th>
        <!-- <th>Requirement to Proceed</th> -->
    </tr>
  </thead>
  <tbody>
    {% for user in users %}
      <tr>
    		<td>{{ user.id }}</td>
            <td>{{ user.full_name }}</td>
            <td>{{ user.cwl }}</td>
            <td>{{ user.ubcEmail }}</td>
            <td>{{ user.lfsRole }}</td>
            <td>{{ user.ubc_affiliation }}</td>
            <td>{{ user.supervisor_first_name }}</td>
            <td>{{ user.supervisor_last_name }}</td>
            <td>{{ user.supervisor_email }}</td>
            <td>{{ user.after_hours_access }}</td>
            <td>{{ user.building_name }}</td>
            <td>{{ user.room_numbers }}</td>
            <td>{{ user.additional_comments }}</td>
            <!-- <td>{{ user.requirement_to_proceed|yesno:"Yes,No" }}</td> -->
      </tr>

		{% empty %}

			<tr>
				<td colspan="13">No key requests found</td>
			</tr>

    {% endfor %}
  </tbody>
</table>

{% include 'app/subpages/_pagination.html' with data=users %}

{% endblock %}
